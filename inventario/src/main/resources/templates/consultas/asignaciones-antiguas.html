<!DOCTYPE html>
<html th:replace="~{layout/base :: layout(~{::section})}">
<body>
    <section>
        <h2 style="color: #ff6b35; margin-bottom: 1.5rem;">üî¥ Equipos con Asignaci√≥n Antigua</h2>
        
        <p style="color: #666; margin-bottom: 2rem;">
            Esta consulta muestra equipos que llevan mucho tiempo asignados al mismo usuario. 
            √ötil para detectar equipos que necesitan renovaci√≥n o revisi√≥n.
        </p>
        
        <!-- Secci√≥n ROJA: M√°s de 1 a√±o -->
        <div th:if="${asignacionesMuyAntiguas.size() > 0}">
            <div class="alert-consulta alert-danger">
                <h3 style="margin: 0 0 10px 0; color: #721c24;">
                    üî¥ M√ÅS DE 1 A√ëO (<span th:text="${asignacionesMuyAntiguas.size()}">0</span> equipos)
                </h3>
                <p style="margin: 0;">Equipos asignados hace m√°s de 365 d√≠as</p>
            </div>
            
            <div th:each="inv : ${asignacionesMuyAntiguas}" 
                 style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #dc3545;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4 style="margin: 0 0 5px 0; color: #333;">
                            <span th:text="${inv.equipo.tipoObjeto != null ? inv.equipo.tipoObjeto.nombre : 'Equipo'}">Tipo</span>: 
                            <span th:text="${inv.equipo.modelo.nombre}">Modelo</span>
                        </h4>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">
                            N¬∫ Serie: <span th:text="${inv.equipo.numeroSerie ?: 'N/A'}">Serie</span>
                        </p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <p style="margin: 0;">
                            üë§ <strong th:text="${inv.usuario.nombre + ' ' + inv.usuario.apellidos}">Usuario</strong>
                        </p>
                    </div>
                    <div style="text-align: right; min-width: 150px;">
                        <p style="margin: 0;">
                            üìÖ <span th:text="${#temporals.format(inv.fechaAsignacion, 'dd/MM/yyyy')}">Fecha</span>
                        </p>
                        <p style="margin: 5px 0 0 0; color: #dc3545; font-weight: bold;">
                            ‚è±Ô∏è <span th:text="${diasPorAsignacion[inv.id]}">0</span> d√≠as
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n AMARILLA: M√°s de 6 meses -->
        <div th:if="${asignacionesAntiguas.size() > 0}" style="margin-top: 30px;">
            <div class="alert-consulta alert-warning">
                <h3 style="margin: 0 0 10px 0; color: #856404;">
                    üü° M√ÅS DE 6 MESES (<span th:text="${asignacionesAntiguas.size()}">0</span> equipos)
                </h3>
                <p style="margin: 0;">Equipos asignados hace m√°s de 180 d√≠as</p>
            </div>
            
            <div th:each="inv : ${asignacionesAntiguas}" 
                 style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4 style="margin: 0 0 5px 0; color: #333;">
                            <span th:text="${inv.equipo.tipoObjeto != null ? inv.equipo.tipoObjeto.nombre : 'Equipo'}">Tipo</span>: 
                            <span th:text="${inv.equipo.modelo.nombre}">Modelo</span>
                        </h4>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">
                            N¬∫ Serie: <span th:text="${inv.equipo.numeroSerie ?: 'N/A'}">Serie</span>
                        </p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <p style="margin: 0;">
                            üë§ <strong th:text="${inv.usuario.nombre + ' ' + inv.usuario.apellidos}">Usuario</strong>
                        </p>
                    </div>
                    <div style="text-align: right; min-width: 150px;">
                        <p style="margin: 0;">
                            üìÖ <span th:text="${#temporals.format(inv.fechaAsignacion, 'dd/MM/yyyy')}">Fecha</span>
                        </p>
                        <p style="margin: 5px 0 0 0; color: #ffc107; font-weight: bold;">
                            ‚è±Ô∏è <span th:text="${diasPorAsignacion[inv.id]}">0</span> d√≠as
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mensaje si no hay asignaciones antiguas -->
        <div th:if="${asignacionesMuyAntiguas.size() == 0 && asignacionesAntiguas.size() == 0}" 
             class="alert-consulta badge-success" style="background: #d4edda; border-left-color: #28a745;">
            <p style="margin: 0;">‚úÖ ¬°Excelente! No hay asignaciones antiguas. Todas las asignaciones son recientes.</p>
        </div>
        
        <div style="margin-top: 2rem; text-align: center;">
            <a href="/consultas" class="btn-secondary" style="padding: 10px 20px; text-decoration: none;">
                ‚Üê Volver a Consultas
            </a>
        </div>
    </section>
</body>
</html>
